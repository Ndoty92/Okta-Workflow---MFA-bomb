{"type":"flopack","version":"1.3.0","created":"2022-09-26T15:24:28.339Z","flags":{"auto-transform":true,"looseBooleans":true,"looseStrings":true,"looseNulls":true},"data":{"flos":{"d4cb9a88-a429-4bd5-b738-6bbcb181b6eb":{"id":"d4cb9a88-a429-4bd5-b738-6bbcb181b6eb","name":"MFA Bombing","description":"","data":{"id":null,"uuid":"d4cb9a88-a429-4bd5-b738-6bbcb181b6eb","display":{"preview":[{"module":"http","name":"accept","kernel":true},{"module":"object","name":"pick","kernel":true},{"module":"date","name":"subtract","kernel":true},{"module":"okta","name":"searchSystemLogs","kernel":false},{"module":"list","name":"pluck","kernel":true},{"module":"control","name":"comment","kernel":true},{"module":"control","name":"comment","kernel":true},{"module":"control","name":"continueIf","kernel":true},{"module":"list","name":"length","kernel":true},{"module":"control","name":"comment","kernel":true},{"module":"control","name":"comment","kernel":true},{"module":"control","name":"comment","kernel":true},{"module":"control","name":"comment","kernel":true},{"module":"control","name":"continueIf","kernel":true},{"module":"control","name":"comment","kernel":true},{"module":"okta","name":"clearUserSessions","kernel":false},{"module":"control","name":"comment","kernel":true},{"module":"control","name":"comment","kernel":true},{"module":"control","name":"continueIf","kernel":true},{"module":"okta","name":"addNewUserToGroup","kernel":false},{"module":"control","name":"comment","kernel":true}],"isCallable":false,"isPublishable":true},"tree":{"id":2,"name":"empty","description":"This flow has been build w/o a tree and uses the newer, async, Addressing module."},"methods":[{"joins":{},"address":"root:kernel:http:0.0.1:accept","parents":{"version":{"address":"root:kernel:http:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:http","key":"http","data":{"name":"http"}}},"uuid":"Kzq92Ni4g","branches":{},"node":{"key":"accept","data":{"name":"API Endpoint"},"model":{"type":"method","_v":2,"key":"accept","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":true,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"API Endpoint","description":"Accept input to start a Flow."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"groupRules":{},"data":{"giM61TPryg":{"id":"giM61TPryg","group":"raw","key":"headers","value":{"type":"object","collection":false,"data":{}},"ref":false,"metadata":{"hidden":true,"index":0},"required":false,"flags":"d"},"3LpxywW0zm":{"id":"3LpxywW0zm","group":"raw","key":"body","value":{"type":"string","collection":false,"data":""},"ref":false,"metadata":{"hidden":true,"index":1},"required":false,"flags":"d","_used":true},"q4LUr32h-B":{"id":"q4LUr32h-B","group":"raw","key":"query","value":{"type":"string","collection":false,"data":""},"ref":false,"metadata":{"hidden":true,"index":2},"required":false,"flags":"d"},"NgHH-FEiQx":{"id":"NgHH-FEiQx","group":"context","key":"execution_id","value":{"error":false,"type":"string","collection":false,"data":null,"available":[]},"ref":false,"metadata":{"displayname":"Execution ID","index":3},"required":false,"flags":"d"}}},"outputs":{"extensible":false,"rules":{"*":{"types":["*"],"collection":"*"}},"groupRules":{"body":{"type":"object","reserved":{},"extensible":true},"headers":{"type":"object","reserved":{"Content-Type":"string"},"extensible":true},"query":{"type":"object","reserved":{},"extensible":true},"context":{"extensible":false}},"data":{"xWb_kf1CtU":{"id":"xWb_kf1CtU","group":"raw","key":"headers","value":{"type":"object","collection":false,"data":{}},"ref":false,"metadata":{"hidden":true,"index":0}},"UE2OtE6-Dj":{"id":"UE2OtE6-Dj","group":"raw","key":"body","value":{"type":"string","collection":false,"data":""},"ref":false,"metadata":{"hidden":true,"index":1},"_used":true},"gFSDNjPDhd":{"id":"gFSDNjPDhd","group":"raw","key":"query","value":{"type":"string","collection":false,"data":""},"ref":false,"metadata":{"hidden":true,"index":2}},"DFy0Hk9Xjc":{"id":"DFy0Hk9Xjc","group":"context","key":"execution_id","value":{"error":false,"type":"string","collection":false,"data":null,"available":[]},"ref":false,"metadata":{"displayname":"Execution ID","index":3}}}},"runtime":{}}},"pins":{"UE2OtE6-Dj":{"oNO89bcLU":[{"input":"RK5SatW48q","transform":{"UE2OtE6-Dj":{"convert":"parse","forceWrapArray":false,"dest":"UE2OtE6-Dj"}}}]}}},{"joins":{},"address":"root:kernel:object:0.0.1:pick","parents":{"version":{"address":"root:kernel:object:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:object","key":"object","data":{"name":"object"}}},"uuid":"oNO89bcLU","branches":{},"node":{"key":"pick","data":{"name":"Get Multiple"},"model":{"type":"method","_v":2,"key":"pick","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Get Multiple","description":"Pick several values from an object at once."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"rules":{"object":{"types":["object"],"collection":"*"}},"data":{"RK5SatW48q":{"id":"RK5SatW48q","group":null,"key":"object","value":{"type":"object","collection":false,"data":{},"available":[],"error":false},"required":true,"ref":false,"metadata":{"index":0},"flags":"d"}}},"outputs":{"extensible":true,"rules":{"*":{"types":["*"],"collection":"*"}},"data":{"WqQ4SxhOp":{"id":"WqQ4SxhOp","group":null,"key":"data.events.0.outcome.result","value":{"error":false,"type":"string","collection":false,"data":"","available":["string","number","boolean","Date","Array","object","file","flo","folder"]},"ref":false,"metadata":{"index":0,"custom":true}},"sGrS_oDLR":{"id":"sGrS_oDLR","group":null,"key":"data.events.0.actor.id","value":{"error":false,"type":"string","collection":false,"data":"","available":["string","number","boolean","Date","Array","object","file","flo","folder"]},"ref":false,"metadata":{"index":1,"custom":true},"_used":true},"ODKcSBYJF":{"id":"ODKcSBYJF","group":null,"key":"data.events.0.published","value":{"error":false,"type":"string","collection":false,"data":"","available":["string","number","boolean","Date","Array","object","file","flo","folder"]},"ref":false,"metadata":{"index":2,"custom":true},"_used":true},"hdqpEcR3i":{"id":"hdqpEcR3i","group":null,"key":"data.events.0.debugContext.debugData.factor","value":{"error":false,"type":"string","collection":false,"data":"","available":["string","number","boolean","Date","Array","object","file","flo","folder"]},"ref":false,"metadata":{"index":3,"custom":true,"description":"","displayname":"data.events.0.debugContext.debugData.factor"},"_used":true}}},"runtime":{}}},"pins":{"sGrS_oDLR":{"0um5M9fz8":[{"input":"F55U5B8SeU","transform":null}],"umkuaMH6m":[{"input":"VfoTMSy-8","transform":null}],"TKRbhLczb":[{"input":"lsN-hJgvpv","transform":null}]},"ODKcSBYJF":{"2MgC6ejRZ":[{"input":"JnVVx8j0q6","transform":{"ODKcSBYJF":{"convert":"dateTime","forceWrapArray":false,"dest":"ODKcSBYJF"}}}],"umkuaMH6m":[{"input":"bbzDTV7U6r","transform":{"ODKcSBYJF":{"convert":"dateTime","forceWrapArray":false,"dest":"ODKcSBYJF"}}}]},"hdqpEcR3i":{"GxRKVlcjQ":[{"input":"jNY0xwtyZK","transform":null}],"oAiroSJqs":[{"input":"4SQfvnJDRz","transform":null}]}}},{"joins":{},"address":"root:kernel:date:0.0.1:subtract","parents":{"version":{"address":"root:kernel:date:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:date","key":"date","data":{"name":"date"}}},"uuid":"2MgC6ejRZ","branches":{},"node":{"key":"subtract","data":{"name":"Subtract"},"model":{"type":"method","_v":2,"key":"subtract","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Subtract","description":"Subtract a multiple of a unit of time (e.g. seconds) from a starting date & time."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"data":{"JnVVx8j0q6":{"id":"JnVVx8j0q6","group":null,"key":"start","value":{"type":"Date","collection":false,"data":"","available":[],"error":false},"required":true,"ref":false,"metadata":{"displayname":"start date","index":0},"flags":"d"},"WmS2AFvw8-":{"id":"WmS2AFvw8-","group":null,"key":"scale","value":{"type":"number","collection":false,"data":30,"available":[],"error":false},"required":true,"ref":false,"metadata":{"displayname":"subtract","index":1},"flags":"d"},"TsXnnMZ83O":{"id":"TsXnnMZ83O","group":null,"key":"unit","value":{"type":"string","collection":false,"data":"minutes","available":[],"error":false},"required":true,"ref":false,"metadata":{"choices":["milliseconds","seconds","minutes","hours","days","weeks","months","years"],"displayname":"units","index":2},"flags":"d"}}},"outputs":{"extensible":false,"data":{"juXtPV5pKd":{"id":"juXtPV5pKd","group":null,"key":"output","value":{"type":"Date","collection":false,"data":null,"available":[],"error":false},"ref":false,"metadata":{"index":0,"description":"","displayname":"searchsince"},"_used":true}}},"runtime":{}}},"pins":{"juXtPV5pKd":{"umkuaMH6m":[{"input":"19ksO_sZtm","transform":null}]}}},{"joins":{},"address":"root:channels:http:okta:1.0.592:searchSystemLogs","parents":{"version":{"address":"root:channels:http:okta:1.0.592","key":"1.0.592","data":{"name":"1.0.592","id":1735}},"channel":{"address":"root:channels:http:okta","key":"okta","data":{"name":"okta","id":17}}},"uuid":"umkuaMH6m","branches":{},"node":{"key":"searchSystemLogs","data":{"name":"Search System Logs"},"model":{"type":"method","_v":2,"key":"searchSystemLogs","executable":true,"displayed":true,"async":true,"cooperative":false,"mirrored":false,"compat":false,"inlined":false,"dependencies":[],"timeout":30000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":49089,"name":"Search System Logs","description":null},"meta":{"cda7ac50-77f8-4731-925b-f4e2ee705ddf":{"id":"ug3GlLLOvZd","address":{"key":null,"group":null,"groupIndex":0,"defaultValue":{"method":"getSearchSysLogsInputs"},"namespace":"input"}},"055ae433-dc52-4ceb-8f7a-df2c8916e18c":{"id":"1dreLscLlDD","address":{"key":null,"group":"Result","fieldIndex":0,"defaultValue":{"path":[],"method":"getSearchSysLogsOutputs"},"namespace":"output"}}},"config":"95083020-2120-4504-aff6-c010b3e78b54","partnerChannelKeys":206,"inputs":{"extensible":false,"rules":{},"groupRules":{"Search By":{"index":0}},"data":{"_zz1e9Q51e":{"id":"_zz1e9Q51e","group":"parameters","key":"searchBy","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"Expression","available":[]},"required":false,"ref":false,"metadata":{"type":"list","displayname":"Search By","choices":[{"label":"Expression","value":"Expression"},{"label":"Keyword","value":"Keyword"}],"dependencies":[],"optional":false,"ordering":0,"index":0},"flags":"p"},"deMP-kuLai":{"id":"deMP-kuLai","group":"parameters","key":"resultSet","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"First 200 Matching Records","available":[]},"required":false,"ref":false,"metadata":{"type":"list","displayname":"Result Set","choices":[{"label":"First Matching Record","value":"First Matching Record"},{"label":"First 200 Matching Records","value":"First 200 Matching Records"},{"label":"Stream Matching Records","value":"Stream Matching Records"}],"dependencies":[],"optional":false,"ordering":1,"index":3},"flags":"p"},"19ksO_sZtm":{"id":"19ksO_sZtm","group":"Date","key":"since","value":{"error":false,"proxy":false,"check":false,"type":"Date","collection":false,"data":"","available":["Date"]},"required":false,"ref":false,"metadata":{"index":1,"displayname":"Since","optional":false},"flags":"d"},"bbzDTV7U6r":{"id":"bbzDTV7U6r","group":"Date","key":"until","value":{"error":false,"proxy":false,"check":false,"type":"Date","collection":false,"data":"","available":["Date"]},"required":false,"ref":false,"metadata":{"index":2,"displayname":"Until","optional":false},"flags":"d"},"YuzsTKWcE":{"id":"YuzsTKWcE","group":"Search By","key":"Custom Filter","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"eventType co  \"send_factor\"","available":["string"]},"required":false,"ref":false,"metadata":{"index":5,"optional":false},"flags":"d"},"VfoTMSy-8":{"id":"VfoTMSy-8","group":"Search By","key":"target.id","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"","available":["string"]},"required":false,"ref":false,"metadata":{"index":4,"displayname":"Target ID","optional":false},"flags":"d"}}},"outputs":{"extensible":false,"rules":{},"groupRules":{"Result":{"extensible":false,"reserved":{},"index":0,"type":"object"}},"data":{"ZrUp8w9Mc_":{"id":"ZrUp8w9Mc_","group":"Result","key":"System Logs","value":{"error":false,"type":{"Target":{"type":"object","collection":true,"displayname":null},"Raw Output":{"type":"object","collection":false,"displayname":null}},"collection":true,"data":[],"available":["object"]},"ref":true,"metadata":{"index":0},"_used":true}}},"runtime":{},"display":{},"comments":"Search for log events from your organization's system log in Okta.","enableNewMetadata":true}},"pins":{"ZrUp8w9Mc_":{"Ty9ttILS7":[{"input":"ua1LJ9QYu2","transform":null}]}}},{"joins":{},"address":"root:kernel:list:0.0.1:pluck","parents":{"version":{"address":"root:kernel:list:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:list","key":"list","data":{"name":"list"}}},"uuid":"Ty9ttILS7","branches":{},"node":{"key":"pluck","data":{"name":"Pluck"},"model":{"type":"method","_v":2,"key":"pluck","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Pluck","description":"Given a list of objects, create a new list using only a specified portion from each object."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"rules":{"list":{"types":["object"],"collection":true}},"data":{"ua1LJ9QYu2":{"id":"ua1LJ9QYu2","group":null,"key":"list","value":{"type":{"UUID":{"type":"string","collection":false,"displayname":null},"Published":{"type":"Date","collection":false,"displayname":null},"Event Type":{"type":"string","collection":false,"displayname":null},"Severity":{"type":"string","collection":false,"displayname":null},"Display Message":{"type":"string","collection":false,"displayname":null},"Actor":{"type":{"ID":{"type":"string","collection":false,"displayname":null},"Type":{"type":"string","collection":false,"displayname":null},"Alternate ID":{"type":"string","collection":false,"displayname":null},"Display Name":{"type":"string","collection":false,"displayname":null}},"collection":false,"displayname":null},"Target":{"type":"object","collection":true,"displayname":null},"Client":{"type":{"ID":{"type":"string","collection":false,"displayname":null},"User Agent":{"type":"object","collection":false,"displayname":null},"Geographical Context":{"type":"object","collection":false,"displayname":null},"Zone":{"type":"string","collection":false,"displayname":null},"IP Address":{"type":"string","collection":false,"displayname":null},"Device":{"type":"string","collection":false,"displayname":null}},"collection":false,"displayname":null},"Request":{"type":{"IP Chain":{"type":"object","collection":true,"displayname":null}},"collection":false,"displayname":null},"Raw Output":{"type":"object","collection":false,"displayname":null}},"collection":true,"data":[],"available":[],"error":false},"required":true,"ref":false,"metadata":{"index":0},"flags":"d"},"7ydqYxZrB9":{"id":"7ydqYxZrB9","group":null,"key":"key","value":{"type":"string","collection":false,"data":"Raw Output.eventType","available":[],"error":false},"required":false,"ref":false,"metadata":{"index":1},"flags":"d"}}},"outputs":{"extensible":false,"rules":{"values":{"types":["*"],"collection":true}},"data":{"YZQoJD-We2":{"id":"YZQoJD-We2","group":null,"key":"values","value":{"type":"object","collection":true,"data":null,"available":["*"],"error":false},"ref":true,"metadata":{"index":0,"description":"","displayname":"authenticatorValues"},"_used":true}}},"runtime":{}}},"pins":{"YZQoJD-We2":{"XJnd2j4Am":[{"input":"vsRsjn3NpJ","transform":null}]}}},{"joins":{},"address":"root:kernel:control:0.0.1:comment","parents":{"version":{"address":"root:kernel:control:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:control","key":"control","data":{"name":"control"}}},"uuid":"Aw6I4T7W6","branches":{},"node":{"key":"comment","data":{"name":"Comment"},"model":{"type":"method","_v":2,"key":"comment","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Comment","description":"Leave a comment."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"data":{}},"outputs":{"extensible":false,"data":{}},"runtime":{},"display":{},"comments":{"title":"Purpose of Workflow","markdown":"Identify MFA bombing attempts (push/SMS) where the user responded. \n\nWorkflow will trigger via an Okta Event hook every time an authenticator is used (success or failure) of any type.  Once used, it discards password authenticators (not a push bomb scenario).  The system log is checked for a defined period.  If the number of send factor pushes exceeds the threshold, action is taken."}}},"pins":{}},{"joins":{},"address":"root:kernel:control:0.0.1:comment","parents":{"version":{"address":"root:kernel:control:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:control","key":"control","data":{"name":"control"}}},"uuid":"aiqVeG-c8","branches":{},"node":{"key":"comment","data":{"name":"Comment"},"model":{"type":"method","_v":2,"key":"comment","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Comment","description":"Leave a comment."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"data":{}},"outputs":{"extensible":false,"data":{}},"runtime":{},"display":{},"comments":{"title":"","markdown":"Filtering out password authentication & fastpass requests as those aren't considered MFA bombs"}}},"pins":{}},{"joins":{},"address":"root:kernel:control:0.0.1:continueIf","parents":{"version":{"address":"root:kernel:control:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:control","key":"control","data":{"name":"control"}}},"uuid":"GxRKVlcjQ","branches":{},"node":{"key":"continueIf","data":{"name":"Continue If"},"model":{"type":"method","_v":2,"key":"continueIf","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Continue If","description":"Stop the Flow if a condition isn't true."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"rules":{"left-operand":{"types":["object","string","number","Date","boolean"]},"right-operand":{"types":["object","string","number","Date","boolean"]}},"data":{"jNY0xwtyZK":{"id":"jNY0xwtyZK","group":null,"key":"left-operand","value":{"type":"string","collection":false,"data":"","available":["object","string","number","Date","boolean"],"error":false},"required":false,"ref":false,"metadata":{"index":0,"displayname":"value a"},"flags":"d"},"CJWIbH0aMU":{"id":"CJWIbH0aMU","group":null,"key":"operator","value":{"type":"string","collection":false,"data":"!=","available":[],"error":false},"required":false,"ref":false,"metadata":{"index":1,"choices":[{"value":"==","label":"equal to"},{"value":"!=","label":"not equal"},{"value":">=","label":"greater than or equal"},{"value":"<=","label":"less than or equal"},{"value":">","label":"greater than"},{"value":"<","label":"less than"},{"value":"%","label":"a multiple of"},{"value":"in","label":"in"},{"value":"not in","label":"not in"},{"value":"has","label":"has key"},{"value":"doesn't have","label":"doesn't have key"},{"value":"is empty","label":"is empty"},{"value":"is not empty","label":"is not empty"}],"displayname":"comparison"},"flags":"d"},"BWeLIwMSfy":{"id":"BWeLIwMSfy","group":null,"key":"right-operand","value":{"type":"string","collection":false,"data":"PASSWORD_AS_FACTOR","available":["object","string","number","Date","boolean"],"error":false},"required":false,"ref":false,"metadata":{"index":2,"displayname":"value b"},"flags":"d"},"K0Yc3gK8qc":{"id":"K0Yc3gK8qc","group":"otherwise","key":"message","value":{"type":"string","collection":false,"data":"Stopping flow, auth request is password","available":["*"],"error":false},"required":false,"ref":false,"metadata":{"index":3},"flags":"d"}}},"outputs":{"extensible":false,"data":{"oI5GL3UkRa":{"id":"oI5GL3UkRa","group":null,"key":"message","value":{"type":"string","collection":false,"data":null},"ref":false,"metadata":{"hidden":true,"displayed":false,"index":0}}}},"runtime":{}}},"pins":{}},{"joins":{},"address":"root:kernel:list:0.0.1:length","parents":{"version":{"address":"root:kernel:list:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:list","key":"list","data":{"name":"list"}}},"uuid":"XJnd2j4Am","branches":{},"node":{"key":"length","data":{"name":"Length"},"model":{"type":"method","_v":2,"key":"length","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Length","description":"Count the number of items in a list."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"rules":{"list":{"types":["*"],"collection":true}},"data":{"vsRsjn3NpJ":{"id":"vsRsjn3NpJ","group":null,"key":"list","value":{"type":"object","collection":true,"data":[],"available":["*"],"error":false},"required":true,"ref":false,"metadata":{"index":0,"ghost":{"displayChannelName":"list","displayName":"authenticatorValues","id":"f6k4WHqN4a@"}},"flags":"d"}}},"outputs":{"extensible":false,"data":{"QcgULyWQCo":{"id":"QcgULyWQCo","group":null,"key":"length","value":{"type":"number","collection":false,"data":0,"available":[],"error":false},"ref":false,"metadata":{"index":0,"description":"","displayname":"numberOfAuthenticatorAttempts"},"_used":true}}},"runtime":{}}},"pins":{"QcgULyWQCo":{"mmJD9dlqY":[{"input":"FSmGPqr2M9","transform":null}]}}},{"joins":{},"address":"root:kernel:control:0.0.1:comment","parents":{"version":{"address":"root:kernel:control:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:control","key":"control","data":{"name":"control"}}},"uuid":"-2CMxNrrJ","branches":{},"node":{"key":"comment","data":{"name":"Comment"},"model":{"type":"method","_v":2,"key":"comment","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Comment","description":"Leave a comment."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"data":{}},"outputs":{"extensible":false,"data":{}},"runtime":{},"display":{},"comments":{"title":"","markdown":"Setting the timeframe to search logs.  Log search goes back X  minutes from timestamp of event that triggered the workflow\n\n--->>>> Change search time here"}}},"pins":{}},{"joins":{},"address":"root:kernel:control:0.0.1:comment","parents":{"version":{"address":"root:kernel:control:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:control","key":"control","data":{"name":"control"}}},"uuid":"fnvkpYzNB","branches":{},"node":{"key":"comment","data":{"name":"Comment"},"model":{"type":"method","_v":2,"key":"comment","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Comment","description":"Leave a comment."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"data":{}},"outputs":{"extensible":false,"data":{}},"runtime":{},"display":{},"comments":{"title":"","markdown":"Getting the push events"}}},"pins":{}},{"joins":{},"address":"root:kernel:control:0.0.1:comment","parents":{"version":{"address":"root:kernel:control:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:control","key":"control","data":{"name":"control"}}},"uuid":"5YtJlIQ0q","branches":{},"node":{"key":"comment","data":{"name":"Comment"},"model":{"type":"method","_v":2,"key":"comment","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Comment","description":"Leave a comment."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"data":{}},"outputs":{"extensible":false,"data":{}},"runtime":{},"display":{},"comments":{"title":"","markdown":"Log search looks only for an MFA Event with the ID of the user that triggered the workflow."}}},"pins":{}},{"joins":{},"address":"root:kernel:control:0.0.1:comment","parents":{"version":{"address":"root:kernel:control:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:control","key":"control","data":{"name":"control"}}},"uuid":"KfmnBZwbS","branches":{},"node":{"key":"comment","data":{"name":"Comment"},"model":{"type":"method","_v":2,"key":"comment","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Comment","description":"Leave a comment."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"data":{}},"outputs":{"extensible":false,"data":{}},"runtime":{},"display":{},"comments":{"title":"","markdown":"counting instances push events"}}},"pins":{}},{"joins":{},"address":"root:kernel:control:0.0.1:continueIf","parents":{"version":{"address":"root:kernel:control:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:control","key":"control","data":{"name":"control"}}},"uuid":"mmJD9dlqY","branches":{},"node":{"key":"continueIf","data":{"name":"Continue If"},"model":{"type":"method","_v":2,"key":"continueIf","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Continue If","description":"Stop the Flow if a condition isn't true."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"rules":{"left-operand":{"types":["object","string","number","Date","boolean"]},"right-operand":{"types":["object","string","number","Date","boolean"]}},"data":{"FSmGPqr2M9":{"id":"FSmGPqr2M9","group":null,"key":"left-operand","value":{"type":"number","collection":false,"data":0,"available":["object","string","number","Date","boolean"],"error":false},"required":false,"ref":false,"metadata":{"index":0,"displayname":"value a"},"flags":"d"},"BL_jWckZNG":{"id":"BL_jWckZNG","group":null,"key":"operator","value":{"type":"string","collection":false,"data":">=","available":[],"error":false},"required":false,"ref":false,"metadata":{"index":1,"choices":[{"value":"==","label":"equal to"},{"value":"!=","label":"not equal"},{"value":">=","label":"greater than or equal"},{"value":"<=","label":"less than or equal"},{"value":">","label":"greater than"},{"value":"<","label":"less than"},{"value":"%","label":"a multiple of"},{"value":"in","label":"in"},{"value":"not in","label":"not in"},{"value":"has","label":"has key"},{"value":"doesn't have","label":"doesn't have key"},{"value":"is empty","label":"is empty"},{"value":"is not empty","label":"is not empty"}],"displayname":"comparison"},"flags":"d"},"_SRsgh8mhE":{"id":"_SRsgh8mhE","group":null,"key":"right-operand","value":{"type":"number","collection":false,"data":5,"available":["object","string","number","Date","boolean"],"error":false},"required":false,"ref":false,"metadata":{"index":2,"displayname":"value b"},"flags":"d"},"PT6tL5F4Dy":{"id":"PT6tL5F4Dy","group":"otherwise","key":"message","value":{"type":"string","collection":false,"data":"number of sms_push sends too low, stopping flow","available":["*"],"error":false},"required":false,"ref":false,"metadata":{"index":3},"flags":"d"}}},"outputs":{"extensible":false,"data":{"V8qY4A3DLR":{"id":"V8qY4A3DLR","group":null,"key":"message","value":{"type":"string","collection":false,"data":null},"ref":false,"metadata":{"hidden":true,"displayed":false,"index":0}}}},"runtime":{}}},"pins":{}},{"joins":{},"address":"root:kernel:control:0.0.1:comment","parents":{"version":{"address":"root:kernel:control:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:control","key":"control","data":{"name":"control"}}},"uuid":"Tj5X0ejeO","branches":{},"node":{"key":"comment","data":{"name":"Comment"},"model":{"type":"method","_v":2,"key":"comment","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Comment","description":"Leave a comment."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"data":{}},"outputs":{"extensible":false,"data":{}},"runtime":{},"display":{},"comments":{"title":"","markdown":"checking to see if MFA bombing threshold has been met\n\n---->>>>> Change # of attempts here"}}},"pins":{}},{"joins":{},"address":"root:channels:http:okta:1.0.592:clearUserSessions","parents":{"version":{"address":"root:channels:http:okta:1.0.592","key":"1.0.592","data":{"name":"1.0.592","id":1735}},"channel":{"address":"root:channels:http:okta","key":"okta","data":{"name":"okta","id":17}}},"uuid":"0um5M9fz8","branches":{},"node":{"key":"clearUserSessions","data":{"name":"Clear User Sessions"},"model":{"type":"method","_v":2,"key":"clearUserSessions","executable":true,"displayed":true,"async":true,"cooperative":false,"mirrored":false,"compat":false,"inlined":false,"dependencies":[],"timeout":30000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":49054,"name":"Clear User Sessions","description":null},"meta":{},"config":"95083020-2120-4504-aff6-c010b3e78b54","partnerChannelKeys":206,"inputs":{"extensible":false,"rules":{},"groupRules":{"User":{"extensible":false,"reserved":{},"index":0,"type":"object"}},"data":{"F55U5B8SeU":{"id":"F55U5B8SeU","group":"User","key":"ID","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"","available":["string"]},"required":true,"ref":false,"metadata":{"index":0,"optional":false},"flags":"d"},"TTs3KvRCe7":{"id":"TTs3KvRCe7","group":"User","key":"Revoke oauthTokens?","value":{"error":false,"proxy":false,"check":false,"type":"boolean","collection":false,"data":true,"available":["boolean"]},"required":false,"ref":false,"metadata":{"index":1,"optional":false},"flags":"d"}}},"outputs":{"extensible":false,"rules":{},"groupRules":{"Output":{"extensible":false,"reserved":{},"index":0,"type":"object"}},"data":{"88ThSearNC":{"id":"88ThSearNC","group":"Output","key":"Status Code","value":{"error":false,"type":"number","collection":false,"data":0,"available":["number"]},"ref":false,"metadata":{"index":0}}}},"runtime":{},"display":{},"comments":"Removes all active identity provider sessions in Okta, forcing the user to authenticate on the next operation. Optionally revokes OpenID Connect and OAuth refresh and access tokens issued to the user.","enableNewMetadata":true}},"pins":{}},{"joins":{},"address":"root:kernel:control:0.0.1:comment","parents":{"version":{"address":"root:kernel:control:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:control","key":"control","data":{"name":"control"}}},"uuid":"i-ejrITlp","branches":{},"node":{"key":"comment","data":{"name":"Comment"},"model":{"type":"method","_v":2,"key":"comment","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Comment","description":"Leave a comment."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"data":{}},"outputs":{"extensible":false,"data":{}},"runtime":{},"display":{},"comments":{"title":"","markdown":"An MFA bombing event has been triggered.\n\nRecommended action items:\n- clear user sessions\n- add user to group\n- configure Global session policy to block access to group members\n- configure siem alert based on user added to group\n- send user email/notfiy them of next steps"}}},"pins":{}},{"joins":{},"address":"root:kernel:control:0.0.1:comment","parents":{"version":{"address":"root:kernel:control:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:control","key":"control","data":{"name":"control"}}},"uuid":"rAN2PuOBZ","branches":{},"node":{"key":"comment","data":{"name":"Comment"},"model":{"type":"method","_v":2,"key":"comment","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Comment","description":"Leave a comment."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"data":{}},"outputs":{"extensible":false,"data":{}},"runtime":{},"display":{},"comments":{"title":"","markdown":"clearing Sessions"}}},"pins":{}},{"joins":{},"address":"root:kernel:control:0.0.1:continueIf","parents":{"version":{"address":"root:kernel:control:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:control","key":"control","data":{"name":"control"}}},"uuid":"oAiroSJqs","branches":{},"node":{"key":"continueIf","data":{"name":"Continue If"},"model":{"type":"method","_v":2,"key":"continueIf","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Continue If","description":"Stop the Flow if a condition isn't true."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"rules":{"left-operand":{"types":["object","string","number","Date","boolean"]},"right-operand":{"types":["object","string","number","Date","boolean"]}},"data":{"4SQfvnJDRz":{"id":"4SQfvnJDRz","group":null,"key":"left-operand","value":{"type":"string","collection":false,"data":"","available":["object","string","number","Date","boolean"],"error":false},"required":false,"ref":false,"metadata":{"index":0,"displayname":"value a"},"flags":"d"},"Qi0597ZNnb":{"id":"Qi0597ZNnb","group":null,"key":"operator","value":{"type":"string","collection":false,"data":"=="},"required":false,"ref":false,"metadata":{"index":1,"choices":[{"value":"==","label":"equal to"},{"value":"!=","label":"not equal"},{"value":">=","label":"greater than or equal"},{"value":"<=","label":"less than or equal"},{"value":">","label":"greater than"},{"value":"<","label":"less than"},{"value":"%","label":"a multiple of"},{"value":"in","label":"in"},{"value":"not in","label":"not in"},{"value":"has","label":"has key"},{"value":"doesn't have","label":"doesn't have key"},{"value":"is empty","label":"is empty"},{"value":"is not empty","label":"is not empty"}],"displayname":"comparison"},"flags":"d"},"6LZbM-iUBV":{"id":"6LZbM-iUBV","group":null,"key":"right-operand","value":{"type":"string","collection":false,"data":"SIGNED_NONCE","available":["object","string","number","Date","boolean"],"error":false},"required":false,"ref":false,"metadata":{"index":2,"displayname":"value b"},"flags":"d"},"nkM5rHqxLc":{"id":"nkM5rHqxLc","group":"otherwise","key":"message","value":{"type":"string","collection":false,"data":"stopping flow, auth request is FastPass","available":["*"],"error":false},"required":false,"ref":false,"metadata":{"index":3},"flags":"d"}}},"outputs":{"extensible":false,"data":{"yrOFHn9bOU":{"id":"yrOFHn9bOU","group":null,"key":"message","value":{"type":"string","collection":false,"data":null},"ref":false,"metadata":{"hidden":true,"displayed":false,"index":0}}}},"runtime":{}}},"pins":{}},{"joins":{},"address":"root:channels:http:okta:1.0.592:addNewUserToGroup","parents":{"version":{"address":"root:channels:http:okta:1.0.592","key":"1.0.592","data":{"name":"1.0.592","id":1735}},"channel":{"address":"root:channels:http:okta","key":"okta","data":{"name":"okta","id":17}}},"uuid":"TKRbhLczb","branches":{},"node":{"key":"addNewUserToGroup","data":{"name":"Add User to Group"},"model":{"type":"method","_v":2,"key":"addNewUserToGroup","executable":true,"displayed":true,"async":true,"cooperative":false,"mirrored":false,"compat":false,"inlined":false,"dependencies":[],"timeout":30000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":49050,"name":"Add User to Group","description":null},"meta":{},"config":"95083020-2120-4504-aff6-c010b3e78b54","partnerChannelKeys":206,"inputs":{"extensible":false,"rules":{},"groupRules":{"Group":{"extensible":false,"reserved":{},"index":0,"type":"object"},"User":{"extensible":false,"reserved":{},"index":1,"type":"object"}},"data":{"5q59uUUDYK":{"id":"5q59uUUDYK","group":"Group","key":"id","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"00g5ji687panHA4Pr1d7","available":["string"]},"required":true,"ref":false,"metadata":{"displayname":"Group ID","index":0,"optional":false},"flags":"d"},"lsN-hJgvpv":{"id":"lsN-hJgvpv","group":"User","key":"id","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"","available":["string"]},"required":true,"ref":false,"metadata":{"displayname":"User ID","index":1,"optional":false},"flags":"d"}}},"outputs":{"extensible":false,"rules":{},"groupRules":{"Result":{"extensible":false,"reserved":{},"index":0,"type":"object"}},"data":{"vPjZF39wjb":{"id":"vPjZF39wjb","group":"Result","key":"status","value":{"error":false,"type":"number","collection":false,"data":0,"available":["number"]},"ref":false,"metadata":{"displayname":"Status","index":0}}}},"runtime":{},"display":{},"comments":"Adds an Okta user to a group with OKTA_GROUP type.","enableNewMetadata":true}},"pins":{}},{"joins":{},"address":"root:kernel:control:0.0.1:comment","parents":{"version":{"address":"root:kernel:control:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:control","key":"control","data":{"name":"control"}}},"uuid":"9h5qURQdbO","branches":{},"node":{"key":"comment","data":{"name":"Comment"},"model":{"type":"method","_v":2,"key":"comment","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Comment","description":"Leave a comment."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"data":{}},"outputs":{"extensible":false,"data":{}},"runtime":{},"display":{},"comments":{"title":"","markdown":"Adding user to group for identification and action.\n\n---->>>>>> change when changing environments"}}},"pins":{}}],"model":{},"orderings":{"E8I4uyGbJ":["Kzq92Ni4g","Aw6I4T7W6"],"ivIZNx1ocI":["Aw6I4T7W6","oNO89bcLU"],"v43aLVwue5":["oNO89bcLU","aiqVeG-c8"],"wR3ltY8_KX":["aiqVeG-c8","GxRKVlcjQ"],"ptwQdDKU4R":["GxRKVlcjQ","oAiroSJqs"],"OzUioRG7GS":["oAiroSJqs","-2CMxNrrJ"],"o5qQyhdU8_":["-2CMxNrrJ","2MgC6ejRZ"],"oA9dBVXfiS":["2MgC6ejRZ","5YtJlIQ0q"],"lWApLFj_F7":["5YtJlIQ0q","umkuaMH6m"],"HEuADs2UsN":["umkuaMH6m","fnvkpYzNB"],"uKr8BiUloL":["fnvkpYzNB","Ty9ttILS7"],"ruD6BJ3r_q":["Ty9ttILS7","KfmnBZwbS"],"URU-wLTHG0":["KfmnBZwbS","XJnd2j4Am"],"rMESKBl4_n":["XJnd2j4Am","Tj5X0ejeO"],"iyjVxNMTy0":["Tj5X0ejeO","mmJD9dlqY"],"LCIC7yXXE1":["mmJD9dlqY","i-ejrITlp"],"KmysvHbx-0p":["i-ejrITlp","9h5qURQdbO"],"C_48LC71t7x":["9h5qURQdbO","TKRbhLczb"],"Qy9Ah3Bsd07":["TKRbhLczb","rAN2PuOBZ"],"24tOpnb5XZl":["rAN2PuOBZ","0um5M9fz8"]},"cron":{},"security_level":"medium","log":true,"inheritLog":true,"scheduled":false,"group":"26900dfe-fc9f-4dba-b395-09664af4ee40","templateName":null,"connector_method_meta":{"inputs":{},"outputs":{},"options":{}},"monitor_flo":false}}},"configs":{"95083020-2120-4504-aff6-c010b3e78b54":{"id":"95083020-2120-4504-aff6-c010b3e78b54","name":"OIE","module":"okta","data":null}},"tables":{},"groups":{"26900dfe-fc9f-4dba-b395-09664af4ee40":{"id":"26900dfe-fc9f-4dba-b395-09664af4ee40","data":{"name":"Default Folder","description":"","media_uri":""}}}},"checksum":"64ac7fff81562c218f258f196900890126da0ddd8a0cc7367df8ef31f2dd9cd3"}